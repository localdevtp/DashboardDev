var GlassURL="http://glasses.rest.mongodbv1.dev.easylist.com.au/EasyListGlass/";function renderCarLi(a,c,d){return'<li class="'+a+'"><input type="radio" class="listing-'+a+'" id="listing-'+a+"-"+c+'" name="listing-'+a+'" value="'+d+'"/><label class="radio" for="listing-'+a+"-"+c+'">'+d+'<span class="todo-actions"><i class="halflings-icon chevron-right"></i></span></label></li>'} function renderCarLiWithData(a,c,d,f){return'<li class="'+a+'"><input type="radio" data-attribute="'+f+'" class="listing-'+a+'" id="listing-'+a+"-"+c+'" name="listing-'+a+'" value="'+d+'"/><label class="radio" for="listing-'+a+"-"+c+'">'+d+'<span class="todo-actions"><i class="halflings-icon chevron-right"></i></span></label></li>'}function getMake(){return $("input:radio[name=listing-make]:checked").val().trim()} function getModel(){return $("input:radio[name=listing-model]:checked").val().trim()}function getYear(){return $("input:radio[name=listing-year]:checked").val().trim()}function getBodyStyle(){return $("input:radio[name=listing-body-style]:checked").val().trim()}function getTransmission(){return $("input:radio[name=listing-transmission]:checked").val().trim()}function getGlassCode(){return $("input:radio[name=listing-variant]:checked").attr("data-attribute").trim()}$(document).ajaxStart(function(){$("img#loading").show()}); $(document).ajaxComplete(function(){$("img#loading").hide()});$(document).ready(function(){$.getJSON(GlassURL+"AllMakes",function(a){var c=[];$.each(jQuery.parseJSON(a.Result),function(a,f){c.push(renderCarLi("make",a,f))});$("#easylist-make-select").html(c.join(""));$(".listing-make").change(function(a){MakeChange($(this));a.preventDefault();$("form.wizard").formwizard("next")})})}); function MakeChange(){$("#easylist-model-select").empty();var a=getMake();$.getJSON(GlassURL+"info?type=Models&make="+a,function(a){var d=[];$.each(jQuery.parseJSON(a.Result),function(a,c){d.push(renderCarLi("model",a,c))});$("#easylist-model-select").html(d.join(""));$(".listing-model").change(function(a){ModelChange($(this));a.preventDefault();$("form.wizard").formwizard("next")})})} function ModelChange(){$("#easylist-year-select").empty();var a=getMake(),c=getModel();$.getJSON(GlassURL+"info?type=Years&make="+a+"&model="+c,function(a){var c=[];$.each(jQuery.parseJSON(a.Result),function(a,d){c.push(renderCarLi("year",a,d))});$("#easylist-year-select").html(c.join(""));$(".listing-year").change(function(a){YearChange($(this));a.preventDefault();$("form.wizard").formwizard("next")})})} function YearChange(){$("#easylist-body-style-select").empty();var a=getMake(),c=getModel(),d=getYear();$.getJSON(GlassURL+"info?type=Styles&make="+a+"&model="+c+"&year="+d,function(a){var c=[];$.each(jQuery.parseJSON(a.Result),function(a,d){c.push(renderCarLi("body-style",a,d))});$("#easylist-body-style-select").html(c.join(""));$(".listing-body-style").change(function(a){StyleChange($(this));a.preventDefault();$("form.wizard").formwizard("next")})})} function StyleChange(){$("#easylist-transmission-select").empty();var a=getMake(),c=getModel(),d=getYear(),f=getBodyStyle();$.getJSON(GlassURL+"info?type=Transmissions&make="+a+"&model="+c+"&year="+d+"&style="+f,function(a){var c=[];$.each(jQuery.parseJSON(a.Result),function(a,e){c.push(renderCarLi("transmission",a,e))});$("#easylist-transmission-select").html(c.join(""));$(".listing-transmission").change(function(a){TransmissionChange($(this));a.preventDefault();$("form.wizard").formwizard("next")})})} function TransmissionChange(){$("#easylist-variant-select").empty();var a=getMake(),c=getModel(),d=getYear(),f=getBodyStyle(),l=getTransmission();$.getJSON(GlassURL+"MatchingVehicle?make="+a+"&model="+c+"&year="+d+"&style="+f+"&Transmission="+l,function(a){var c=[];$.each(jQuery.parseJSON(a.Result),function(a,d){JSON.stringify(d);var b="";""!=d.Variant&&(b+=d.Variant);""!=d.Series&&(""!=b&&(b+=","),b+=d.Series);""!=d.Cylinder&&(""!=b&&(b+=","),b+=d.Cylinder);""!=d.Engine&&(""!=b&&(b+=","),b+=d.Engine); c.push(renderCarLiWithData("variant",a,b,d.GlassCode))});$("#easylist-variant-select").html(c.join(""));$(".listing-variant").change(function(a){MachingVehicleChange($(this));a.preventDefault();$("form.wizard").formwizard("next")})})} function MachingVehicleChange(){$("#easylist-standard-features").empty();$("#easylist-optional-features").empty();$("#easylist-specs").empty();var a=getMake(),c=getModel(),d=getYear(),f=getBodyStyle();$("#listing-title").val(d+" "+a+" "+c+" "+f.replace("D"," Door"));a=getGlassCode();$.getJSON(GlassURL+"MatchingVehicleFeatures?GlassCode="+a,function(a){var c=[],d=[],e=[];$.each(jQuery.parseJSON(a.Result),function(a,b){var f=b.StandardFeatures.split("|"),j=b.StandardFeaturesName.split("|"),h=b.OptionalFeatures.split("|"), k=b.OptionalFeaturesName.split("|");if(0!=f.Length){for(var g=0;g<f.length;g++)""!=f[g]&&c.push('<label class="checkbox"><input type="checkbox" id="standard-feature-'+f[g]+'" checked="checked" value="'+j[g]+'"/> '+j[g]+"</label>");0<c.length&&$("#easylist-standard-features").html(c.join(""))}if(0!=h.Length){for(g=0;g<h.length;g++)""!=h[g]&&d.push('<label class="checkbox"><input type="checkbox" id="optional-feature-'+h[g]+'" value="'+k[g]+'"/> '+k[g]+"</label>");0<d.length?($("#easylist-optional-features").html(d.join("")), $("#group-optional-features").show()):$("#group-optional-features").hide()}e.push('<input type="hidden" name="vehicle-price-1" value="'+b.NewPrice+'"/>');e.push('<input type="hidden" name="vehicle-price-2" value="'+b.BAV+'"/>');e.push('<input type="hidden" name="vehicle-nvic" value="'+b.NVIC+'"/>');e.push('<input type="hidden" name="vehicle-vin" value="'+b.VinNumber+'"/>');e.push('<input type="hidden" name="vehicle-doors" value="'+b.NoOfDoors+'"/>');e.push('<input type="hidden" name="vehicle-seats" value="'+ b.Seats+'"/>');e.push('<input type="hidden" name="vehicle-drive-type" value="'+b.DriveType+'"/>');e.push('<input type="hidden" name="vehicle-transmission-type" value="'+b.TT+'"/>');e.push('<input type="hidden" name="vehicle-transmission-info" value="'+b.Transmission+'"/>');e.push('<input type="hidden" name="vehicle-engine-type" value="'+b.Engine+'"/>');e.push('<input type="hidden" name="vehicle-engine-cc" value="'+b.CC+'"/>');e.push('<input type="hidden" name="vehicle-engine-size" value="'+b.Size+ '"/>');e.push('<input type="hidden" name="vehicle-engine-cylinders" value="'+b.Cylinder+'"/>');e.push('<input type="hidden" name="vehicle-fuel-type" value="'+b.FuelType+'"/>');e.push('<input type="hidden" name="vehicle-fuel-highway" value="'+b.FuelConsumptionHWay+'"/>');e.push('<input type="hidden" name="vehicle-fuel-city" value="'+b.FuelConsumptionCity+'"/>');e.push('<input type="hidden" name="vehicle-valve-gear" value="'+b.ValveGear+'"/>');0<e.length&&$("#easylist-specs").append(e.join(""));0== c.length&&0==d.length&&$("form.wizard").formwizard("next")})})};